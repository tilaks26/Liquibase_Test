--liquibase formatted sql

--changeset Sneha:1
CREATE TABLE USERS (
  USER_ID    VARCHAR(100) NOT NULL,
  USER_NAME  VARCHAR(100) NOT NULL,
  USER_EMAIL VARCHAR(256) NOT NULL,
  PRIMARY KEY (USER_ID)  
);

--rollback DROP TABLE USERS;

--changeset Sneha:2
CREATE TABLE ACCOUNTS (
  ACCOUNT_ID    VARCHAR(100) NOT NULL,
  USER_ID	VARCHAR(100) NOT NULL,
  ACCOUNT_NAME  VARCHAR(100) NOT NULL,
  CREATION_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (ACCOUNT_ID)  
);

--rollback DROP TABLE ACCOUNTS;

--changeset Sneha:3
INSERT INTO USERS (USER_ID, USER_NAME, USER_EMAIL) VALUES ('U001','Mark','mark@gmail.edu');
INSERT INTO USERS (USER_ID, USER_NAME, USER_EMAIL) VALUES ('U002','Smith','smith@gmail.edu');
INSERT INTO USERS (USER_ID, USER_NAME, USER_EMAIL) VALUES ('U003','John','john@gmail.edu');

INSERT INTO ACCOUNTS (ACCOUNT_ID, USER_ID, ACCOUNT_NAME, CREATION_DATE) VALUES ('A1001','U002','ACC01',NOW());
INSERT INTO ACCOUNTS (ACCOUNT_ID, USER_ID, ACCOUNT_NAME, CREATION_DATE) VALUES ('A1002','U003','ACC02',NOW());

--rollback DELETE FROM ACCOUNTS WHERE ACCOUNT_ID IN ('A1001','A1002');
--rollback DELETE FROM USERS WHERE USER_ID IN ('U001','U002','U003');

--changeset User:4
ALTER TABLE ACCOUNTS ADD CONSTRAINT FK_USER_ID FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID);

--rollback ALTER TABLE ACCOUNTS DROP CONSTRAINT FK_USER_ID;

